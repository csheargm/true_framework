// Clear Test Data Utility
// This script removes all test evaluations from localStorage and Firebase

async function clearTestData() {
    console.log('🧹 Clearing test data...');
    
    // Clear localStorage
    const stored = localStorage.getItem('true_evaluations');
    if (stored) {
        const evaluations = JSON.parse(stored);
        const nonTestEvaluations = evaluations.filter(e => 
            !e.id.includes('limit-test') && 
            !e.id.includes('test-eval') && 
            !e.autoGenerated
        );
        
        localStorage.setItem('true_evaluations', JSON.stringify(nonTestEvaluations));
        console.log(`🗑️ Removed ${evaluations.length - nonTestEvaluations.length} test entries from localStorage`);
    }
    
    // Clear Firebase if available
    if (window.firebaseStorage && window.firebaseStorage.initialized) {
        try {
            const firebaseEvaluations = await window.firebaseStorage.loadEvaluations();
            const nonTestEvaluations = firebaseEvaluations.filter(e => 
                !e.id.includes('limit-test') && 
                !e.id.includes('test-eval') && 
                !e.autoGenerated
            );
            
            await window.firebaseStorage.saveEvaluations(nonTestEvaluations);
            console.log(`🗑️ Removed ${firebaseEvaluations.length - nonTestEvaluations.length} test entries from Firebase`);
            
        } catch (error) {
            console.error('Error clearing Firebase test data:', error);
        }
    }
    
    // Reload the page to refresh data
    if (window.app) {
        window.app.evaluations = window.app.loadEvaluations();
        window.app.renderLeaderboard();
    }
    
    console.log('✅ Test data cleared successfully');
}

// Auto-run if loaded
if (typeof window !== 'undefined') {
    window.clearTestData = clearTestData;
    console.log('🧹 Clear test data utility loaded. Run clearTestData() to remove all test entries.');
}